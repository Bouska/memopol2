{% extends "base.html" %}
{% load comments i18n %}

{% block content %}
<article>
<header><h1 id="name">{{ mep.first_name }} {{ mep.last_name|upper }}{% trans ", member of the european parliament" %}</h1></header>

<section id="summary">
<h1 class="collapsible expanded">{% trans "General information" %}</h1>

<ul id="infos" class="body">

<div class="quickView">
<img class="mugshot" src="{% url meps:mep-picture mep.ep_id %}" onerror="onMugshotError(this);"/>
<span>{{ mep.first_name }} {{ mep.last_name|upper }} <a href="{% url meps:index_by_country mep.country.code %}"><img src="{{ MEDIA_URL }}img/countries/small/{{ mep.country.code }}.png"/></a> </span>
<a href="{% url meps:index_by_group mep.group.abbreviation %}"><img class="grouplogo" src="{{ MEDIA_URL }}img/groups/eu/{{ mep.group.abbreviation|cut:"/" }}.png"/></a><ul>{% for i in mep.achievements %}<li><img alt="{{ i.0 }}" src="{{ MEDIA_URL }}img/trophies/{{ i.1 }}" /></li>{% endfor %}</ul></div>

{% if not mep.active %}<li><div class="nok">{% trans "Former mep" %}</div></li>{% endif %}
<li><i>{% trans "Country" %}</i>:  <a href="{% url meps:index_by_country mep.country.code %}"><img src="{{ MEDIA_URL }}img/countries/small/{{ mep.country.code }}.png"/></a> <a href="{% url meps:index_by_country mep.country.code %}">{{ mep.country.name }} </li></a>
<li><i>{% trans "Political group: " %}</i><a href="{% url meps:index_by_group mep.group.abbreviation %}">{{ mep.group.name }} ({{ mep.group.abbreviation }})</a></li>
{% for partyrepresentative in mep.partyrepresentative_set.all %}
    <li><i>{% trans "National party: " %}</i><a href="{% url meps:index_by_party partyrepresentative.party.id %}">{{ partyrepresentative.party.name }}</a></li>
{% endfor %}
<li><i>Born on</i>
{% blocktrans with mep.birth_date.day as day and mep.birth_date.month as month and mep.birth_date.year as year and mep.birth_place as birth_place %}{{ day }}/{{ month }}/{{ year }}<i> at </i>{{ birth_place }}{% endblocktrans %}</li>
</ul>

<div id="contact">
    <h2 class="collapsible expanded">{% trans "Contact" %}</h2>
    {% include "meps/mep_contact.html" %}
</div>

{% if mep.committeerole_set.all %}
<div id="committees">
    <h2 class="collapsible collapsed">{% trans "Committees" %}</h2>
    <ul class="body">
    {% for role in mep.committeerole_set.all %}
        <li><a href="{% url meps:index_by_committee role.committee.abbreviation %}">{{ role.role }} - {{ role.committee }}</a></li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if mep.current_delegations %}
<div id="delegations">
    <h2 class="collapsible collapsed">{% trans "Delegations" %}</h2>
    <ul class="body">
    {% for role in mep.current_delegations %}
        <li><a href="{% url meps:index_by_delegation role.delegation.id %}">{{ role.role }} - {{ role.delegation }}</a></li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if mep.organizationmep_set.all %}
<div id="staff">
    <h2 class="collapsible collapsed">{% trans "Staff" %}</h2>
        <ul class="body">
    {% for staff in mep.organizationmep_set.all %}
    <li>{{ staff.organization.name }}: {{ staff.role }} {% trans "from" %} {{ staff.begin }} {% if staff.end == "Dec. 31, 9999" %} {% trans "to" %} {{ staff.end }}{% endif %}</li>
    {% endfor %}
        </ul>
</div>
{% endif %}

{% if mep.cv_set.all %}
<div id="cv">
    <h2 class="collapsible collapsed">{% trans "CV" %}</h2>
    <ul class="body">
    {% for line in mep.cv_set.all %}
        <li>{{ line }}</li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if mep.opinionrep_set.all %}
<div id="opinions">
    <h2 class="collapsible collapsed">{% trans "Opinions (memopol v1)" %}</h2>
    <ul class="body">
     {% for line in mep.opinionrep_set.all %}
         <li><b>{{ line.opinion.title }}</b> (le {{ line.date }})<br/>{% autoescape off %}{{ line.opinion.content }}{% endautoescape %} &nbsp; <a target="_" href="{{ line.opinion.url }}"><br/>{% trans "Read more..." %}</a> </li>
     {% endfor %}
    </ul>
</div>
{% endif %}

{% if mep.score_set.all %}
    <div id="scores">
        <h2 class="collapsible expanded">{% trans "Scores average" %} : {{ mep.average_scores|floatformat:0 }}</h2>
        <ul class="body">
        {% for score in mep.score_set.all %}
        <li style="border-color:{{ score.color }};">
          <div class="score-color" style="background-color:{{ score.color }};"></div>
          <div class="inner-score">
            <a href="{% url votes:rep score.proposal.id mep.id %}">{{ score.proposal.title }}</a>: <strong>{{ score.value }}</strong> ({% trans "on" %} {{ score.date }})<br/><a href="http://www.laquadrature.net/wiki/{{ score.proposal.id }}">{% trans "Read more..." %}</a>
          </div>
        </li>
        {% endfor %}
        </ul>
        {% if mep.score_set.all.count > 1 %}
            <img src="{% url trends:trends mep.id %}" />
            <img src="{% url trends:bar_trends mep.id %}" />
        {% endif %}
    </div>
{% endif %}
{% get_comment_list for mep as comment_list %}
{% if comment_list %}
<h2 class="collapsible collapsed">Notes</h2>
   <div class="body">
      {% for comment in comment_list %}
         <div>
            <div>{{ comment.comment }}</div>
            {% if comment.user_url %}<div>{{ comment.user_url }}</div>{% endif %}
            <div>{{ comment.submit_date }}</div>
         </div>
      {% endfor %}
   </div>
{% endif %}
<h2 class="collapsible collapsed">Add note</h2>
<div class="body">
  {% render_comment_form for mep %}
</div>
</section>

</article>

{% endblock %}
{% block documentReady %}

    activateCollapsible();

{% endblock %}
